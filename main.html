<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mensiv Maudy</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(120deg, #fff0f6, #ffe0ec, #ffc0da);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color: #d63384;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      text-align: center;
      overflow-x: hidden;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .music-player {
      margin-top: 20px;
    }

    .music-credit {
      font-size: 0.9em;
      margin-top: 10px;
      color: #ff69b4;
    }

    .photo-container {
      width: 90%;
      max-width: 300px;
      margin-top: 10px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .photo-container img {
      width: 100%;
      display: block;
      transition: opacity 0.5s ease-in-out;
    }

    .message {
      font-size: 0.95em;
      padding: 15px;
      white-space: pre-line;
    }

    .counter {
      margin-top: 10px;
      font-weight: bold;
      font-size: 1em;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 999;
    }

    #visualizer {
      width: 100%;
      height: 60px;
      margin-top: 10px;
    }

    audio {
      display: none;
    }
  </style>
</head>
<body>
  <div class="music-player">
    <audio id="bgMusic" autoplay loop>
      <source src="audio/bersamamu.mp3" type="audio/mpeg" />
      Browser tidak mendukung audio.
    </audio>
    <canvas id="visualizer"></canvas>
    <div class="music-credit">ðŸŽµ Music by Vierra â€“ Bersamamu</div>
  </div>

  <div class="photo-container">
    <img src="images/photo1.jpg" alt="Foto kenangan" id="slideshow-image"/>
  </div>

  <div class="counter" id="counter">Loading...</div>

  <div class="message">
    Happy Mensiv ke 2 tahun 8 bulan ya sayaang! ðŸ’–
    Terimakasih sudah menjadi penyemangat hari hariku selama dua tahun terakhir ini ya,
    selalu jadi maudiaku dan bocilku selamanya ya sayang,
    semoga kita berdua sama sama terus dan sehat terus yaaa supaya kita bisa mencapai tujuan kita berduaa aamiin,

    I lovee youu my little girl!
    Aku sayang kamu selamanyaaa ðŸ’•
  </div>

  <canvas id="effectCanvas"></canvas>

  <script>
    // Counter waktu
    const start = new Date("2022-10-10T13:00:00+07:00"); // Waktu Jakarta
    function updateCounter() {
      const now = new Date();
      const diff = now - start;
      const seconds = Math.floor(diff / 1000);
      const days = Math.floor(seconds / (3600 * 24));
      const hours = Math.floor((seconds % (3600 * 24)) / 3600);
      const minutes = Math.floor((seconds % 3600) / 60);
      const secs = seconds % 60;
      document.getElementById("counter").innerText =
        `${days} hari, ${hours} jam, ${minutes} menit, ${secs} detik bersama ðŸ’ž`;
    }
    setInterval(updateCounter, 1000);
    updateCounter();

    // Slideshow dengan transisi halus
    const photos = ["images/photo1.jpg", "images/photo2.jpg", "images/photo3.jpg"];
    let index = 0;
    setInterval(() => {
      const img = document.getElementById("slideshow-image");
      img.style.opacity = 0;
      setTimeout(() => {
        index = (index + 1) % photos.length;
        img.src = photos[index];
        img.style.opacity = 1;
      }, 500);
    }, 3000);

    // Musik visualizer
    const canvas = document.getElementById("visualizer");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = 60;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const audio = document.getElementById("bgMusic");
    const source = audioCtx.createMediaElementSource(audio);
    const analyser = audioCtx.createAnalyser();
    source.connect(analyser);
    analyser.connect(audioCtx.destination);
    analyser.fftSize = 64;
    const bufferLength = analyser.frequencyBinCount;
    const dataArray = new Uint8Array(bufferLength);

    function drawVisualizer() {
      requestAnimationFrame(drawVisualizer);
      analyser.getByteFrequencyData(dataArray);
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      const barWidth = canvas.width / bufferLength;
      let x = 0;
      for (let i = 0; i < bufferLength; i++) {
        const barHeight = dataArray[i] / 2;
        ctx.fillStyle = "#ff69b4";
        ctx.fillRect(x, canvas.height - barHeight, barWidth - 1, barHeight);
        x += barWidth;
      }
    }
    audio.play().then(() => {
      drawVisualizer();
    }).catch(() => {
      // Autoplay tidak diizinkan
      document.addEventListener('click', () => {
        audio.play();
        drawVisualizer();
      }, { once: true });
    });

    // Animasi love / bunga jatuh
    const effectCanvas = document.getElementById("effectCanvas");
    const ectx = effectCanvas.getContext("2d");
    let hearts = [];

    function resizeEffectCanvas() {
      effectCanvas.width = window.innerWidth;
      effectCanvas.height = window.innerHeight;
    }
    resizeEffectCanvas();
    window.addEventListener("resize", resizeEffectCanvas);

    function drawHeart(x, y, size) {
      ectx.beginPath();
      ectx.moveTo(x, y);
      ectx.bezierCurveTo(x, y - size / 2, x - size, y - size / 2, x - size, y);
      ectx.bezierCurveTo(x - size, y + size / 1.5, x, y + size, x, y + size * 1.5);
      ectx.bezierCurveTo(x, y + size, x + size, y + size / 1.5, x + size, y);
      ectx.bezierCurveTo(x + size, y - size / 2, x, y - size / 2, x, y);
      ectx.fillStyle = Math.random() > 0.5 ? "#ff69b4" : "#ffb6c1";
      ectx.fill();
    }

    function createHeart() {
      hearts.push({
        x: Math.random() * effectCanvas.width,
        y: -10,
        size: Math.random() * 10 + 5,
        speed: Math.random() * 1.5 + 0.5,
      });
    }
    setInterval(createHeart, 300);

    function animateHearts() {
      ectx.clearRect(0, 0, effectCanvas.width, effectCanvas.height);
      hearts.forEach((heart, i) => {
        heart.y += heart.speed;
        drawHeart(heart.x, heart.y, heart.size);
        if (heart.y > effectCanvas.height) hearts.splice(i, 1);
      });
      requestAnimationFrame(animateHearts);
    }
    animateHearts();

    // Popup pesan cinta random
    const loveMessages = [
      "Kamu itu paling lucu deh ðŸ¥°",
      "Hari-hariku selalu cerah karena kamu ðŸŒž",
      "Jangan lupa makan yaa ðŸ˜˜",
      "Kamu semangatku tiap hari ðŸ’–",
      "Maudy paling gemesin di duniaaa ðŸ˜"
    ];
    setInterval(() => {
      const msg = loveMessages[Math.floor(Math.random() * loveMessages.length)];
      alert(msg);
    }, 60000); // tiap 60 detik
  </script>
</body>
</html>
